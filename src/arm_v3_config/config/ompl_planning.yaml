# ============================================================
# OMPL Planning ìµœì í™” ì„¤ì • (ì‹¤íŒ¨ìœ¨ ìµœì†Œí™”)
# ============================================================

# ê¸°ë³¸ í”Œë˜ë„ˆ ì§€ì • (í•„ìˆ˜!)
planning_plugin: ompl_interface/OMPLPlanner

# Request Adapters (ì „ì²˜ë¦¬ ë‹¨ê³„)
request_adapters: >-
  default_planning_request_adapters/ResolveConstraintFrames
  default_planning_request_adapters/ValidateWorkspaceBounds
  default_planning_request_adapters/CheckStartStateBounds
  default_planning_request_adapters/CheckStartStateCollision

# ============================================================
# Planning Pipeline ì„¤ì •
# ============================================================
planning_pipelines:
  - ompl

ompl:
  planning_plugin: ompl_interface/OMPLPlanner
  
  # ============================================================
  # ğŸ”¥ í•µì‹¬ íŒŒë¼ë¯¸í„° (ì‹¤íŒ¨ìœ¨ì— ì§ì ‘ ì˜í–¥)
  # ============================================================
  
  # 1. ê²½ë¡œ í—ˆìš© ì˜¤ì°¨ (ì‘ì„ìˆ˜ë¡ ì •ë°€, í´ìˆ˜ë¡ ì„±ê³µë¥  ë†’ìŒ)
  path_tolerance: 0.1  # ê¸°ë³¸ê°’ 0.1, 0.2ë¡œ ì˜¬ë¦¬ë©´ ë” ê´€ëŒ€
  
  # 2. ë¦¬ìƒ˜í”Œë§ ê°„ê²© (ì‘ì„ìˆ˜ë¡ ë¶€ë“œëŸ¬ì›€)
  resample_dt: 0.1  # 0.1ì´ˆ ê°„ê²©, 0.05ë©´ ë” ì„¸ë°€
  
  # 3. ìµœì†Œ ê°ë„ ë³€í™”ëŸ‰
  min_angle_change: 0.001  # rad, ì‘ì„ìˆ˜ë¡ ì„¸ë°€
  
  # 4. Workspace ê²½ê³„ (ë¡œë´‡ ì‘ì—… ê³µê°„)
  default_workspace_bounds: 10.0  # ì¶©ë¶„íˆ í¬ê²Œ ì„¤ì •
  
  # 5. ì‹œì‘ ìƒíƒœ ì˜¤ì°¨ í—ˆìš©
  start_state_max_bounds_error: 0.1  # 0.05 â†’ 0.1ë¡œ ì¦ê°€ (ê´€ëŒ€)
  start_state_max_dt: 0.5
  
  # 6. ì¶©ëŒ ì²˜ë¦¬
  jiggle_fraction: 0.05  # 0.02 â†’ 0.05 (ì‹œì‘ì  ì¶©ëŒì‹œ ë” ì ê·¹ì ìœ¼ë¡œ ì¡°ì •)
  max_sampling_attempts: 200  # 100 â†’ 200 (ìƒ˜í”Œë§ ì‹œë„ íšŸìˆ˜ ì¦ê°€)

# ============================================================
# ê·¸ë£¹ë³„ ì„¤ì • (arm)
# ============================================================
arm:
  # ì‚¬ìš© ê°€ëŠ¥í•œ í”Œë˜ë„ˆ ëª©ë¡
  planner_configs:
    - RRTConnectkConfigDefault
    - RRTstarkConfigDefault
    - PRMstarkConfigDefault
    - ESTkConfigDefault
    - BKPIECEkConfigDefault
  
  # ê¸°ë³¸ í”Œë˜ë„ˆ (ëª…ì‹œ ì•ˆ í•˜ë©´ ì²« ë²ˆì§¸ ì‚¬ìš©)
  default_planner_config: RRTConnectkConfigDefault
  
  # Projection Evaluator (ì°¨ì› ì¶•ì†Œ)
  projection_evaluator: joints(link1,link2)
  
  # ğŸ”¥ ìœ íš¨ ì„¸ê·¸ë¨¼íŠ¸ ë¹„ìœ¨ (ì‘ì„ìˆ˜ë¡ ì •ë°€, ëŠë¦¼)
  longest_valid_segment_fraction: 0.01  # 0.005 â†’ 0.01 (ì†ë„â†‘)
  
  # Constrained planning (ì•ˆ ì“°ë©´ false)
  enforce_constrained_state_space: false

# ============================================================
# Plannerë³„ ì„¸ë¶€ ì„¤ì •
# ============================================================
planner_configs:
  
  # ------------------------------------------------------------
  # RRTConnect (ê°€ì¥ ë¹ ë¥´ê³  ì•ˆì •ì ) â­ ì¶”ì²œ
  # ------------------------------------------------------------
  RRTConnectkConfigDefault:
    type: geometric::RRTConnect
    range: 0.0  # 0 = ìë™ ê³„ì‚° (ê¶Œì¥)
  
  # ------------------------------------------------------------
  # RRT* (ìµœì  ê²½ë¡œ ì°¾ê¸°, ëŠë¦¼)
  # ------------------------------------------------------------
  RRTstarkConfigDefault:
    type: geometric::RRTstar
    range: 0.0
    goal_bias: 0.05  # ëª©í‘œ í¸í–¥ (ë†’ìœ¼ë©´ ë¹ ë¥´ì§€ë§Œ í’ˆì§ˆâ†“)
    delay_collision_checking: 1  # ì¶©ëŒ ì²´í¬ ì§€ì—° (ì„±ëŠ¥â†‘)
    rewire_factor: 1.1  # ì¬ì—°ê²° ê³„ìˆ˜
  
  # ------------------------------------------------------------
  # PRM* (Probabilistic Roadmap, ë³µì¡í•œ ê³µê°„ì— ìœ ë¦¬)
  # ------------------------------------------------------------
  PRMstarkConfigDefault:
    type: geometric::PRMstar
    max_nearest_neighbors: 10  # ì´ì›ƒ ë…¸ë“œ ìˆ˜
  
  # ------------------------------------------------------------
  # EST (Expansive Space Trees, ì¢ì€ í†µë¡œì— ê°•í•¨)
  # ------------------------------------------------------------
  ESTkConfigDefault:
    type: geometric::EST
    range: 0.0
    goal_bias: 0.05
  
  # ------------------------------------------------------------
  # BKPIECE (Bi-directional KPIECE, ê· í˜•ì¡íŒ íƒìƒ‰)
  # ------------------------------------------------------------
  BKPIECEkConfigDefault:
    type: geometric::BKPIECE
    range: 0.0
    border_fraction: 0.9  # ê²½ê³„ íƒìƒ‰ ë¹„ìœ¨
    failed_expansion_score_factor: 0.5

# ============================================================
# ğŸ¯ ì‹¤íŒ¨ ë°©ì§€ íŒ
# ============================================================
# 1. start_state_max_bounds_error: 0.05 â†’ 0.1
#    â†’ ì‹œì‘ ìì„¸ê°€ ì•½ê°„ ë²—ì–´ë‚˜ë„ í—ˆìš©
#
# 2. max_sampling_attempts: 100 â†’ 200
#    â†’ ìƒ˜í”Œë§ ë” ë§ì´ ì‹œë„
#
# 3. jiggle_fraction: 0.02 â†’ 0.05
#    â†’ ì¶©ëŒ ì‹œ ë” í¬ê²Œ ì›€ì§ì—¬ì„œ íƒˆì¶œ
#
# 4. longest_valid_segment_fraction: 0.005 â†’ 0.01
#    â†’ ê²€ì¦ ê°„ê²© ë„“í˜€ì„œ ì†ë„ í–¥ìƒ
#
# 5. planning_time: 5.0 â†’ 10.0 (ì½”ë“œì—ì„œ ì„¤ì •)
#    â†’ ë” ì˜¤ë˜ ì‹œë„
#
# 6. ì¬ì‹œë„ ë¡œì§ í•„ìˆ˜!
#    â†’ RRTëŠ” í™•ë¥ ì ì´ë¼ í•œ ë²ˆì— ì•ˆ ë  ìˆ˜ ìˆìŒ
# ============================================================